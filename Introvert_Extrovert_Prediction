{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/hadikp/introvert-extrovert-prediction?scriptVersionId=252970979\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"b9e82c03","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2025-07-28T15:59:52.586054Z","iopub.status.busy":"2025-07-28T15:59:52.585819Z","iopub.status.idle":"2025-07-28T15:59:54.058141Z","shell.execute_reply":"2025-07-28T15:59:54.057255Z"},"papermill":{"duration":1.480228,"end_time":"2025-07-28T15:59:54.059325","exception":false,"start_time":"2025-07-28T15:59:52.579097","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["/kaggle/input/playground-series-s5e7/sample_submission.csv\n","/kaggle/input/playground-series-s5e7/train.csv\n","/kaggle/input/playground-series-s5e7/test.csv\n"]}],"source":["# This Python 3 environment comes with many helpful analytics libraries installed\n","# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n","# For example, here's several helpful packages to load\n","\n","import numpy as np # linear algebra\n","import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n","\n","# Input data files are available in the read-only \"../input/\" directory\n","# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n","\n","import os\n","for dirname, _, filenames in os.walk('/kaggle/input'):\n","    for filename in filenames:\n","        print(os.path.join(dirname, filename))\n","\n","# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n","# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"]},{"cell_type":"code","execution_count":2,"id":"cee22065","metadata":{"execution":{"iopub.execute_input":"2025-07-28T15:59:54.069729Z","iopub.status.busy":"2025-07-28T15:59:54.069449Z","iopub.status.idle":"2025-07-28T15:59:54.125792Z","shell.execute_reply":"2025-07-28T15:59:54.124937Z"},"papermill":{"duration":0.062869,"end_time":"2025-07-28T15:59:54.127142","exception":false,"start_time":"2025-07-28T15:59:54.064273","status":"completed"},"tags":[]},"outputs":[],"source":["train_data = pd.read_csv('/kaggle/input/playground-series-s5e7/train.csv')\n","test_data = pd.read_csv('/kaggle/input/playground-series-s5e7/test.csv')\n"]},{"cell_type":"code","execution_count":3,"id":"0d27ed6e","metadata":{"execution":{"iopub.execute_input":"2025-07-28T15:59:54.137974Z","iopub.status.busy":"2025-07-28T15:59:54.137768Z","iopub.status.idle":"2025-07-28T15:59:54.169514Z","shell.execute_reply":"2025-07-28T15:59:54.168642Z"},"papermill":{"duration":0.038122,"end_time":"2025-07-28T15:59:54.1707","exception":false,"start_time":"2025-07-28T15:59:54.132578","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["<class 'pandas.core.series.Series'>\n","RangeIndex: 18524 entries, 0 to 18523\n","Series name: Personality\n","Non-Null Count  Dtype\n","--------------  -----\n","18524 non-null  int64\n","dtypes: int64(1)\n","memory usage: 144.8 KB\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipykernel_19/3786157471.py:1: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`\n","  train_data['Personality'] = train_data['Personality'].replace({'Extrovert': 1, 'Introvert': 0})\n"]}],"source":["train_data['Personality'] = train_data['Personality'].replace({'Extrovert': 1, 'Introvert': 0})\n","y = train_data.pop('Personality')\n","y.info()\n"]},{"cell_type":"code","execution_count":4,"id":"b716bf30","metadata":{"execution":{"iopub.execute_input":"2025-07-28T15:59:54.18029Z","iopub.status.busy":"2025-07-28T15:59:54.180062Z","iopub.status.idle":"2025-07-28T15:59:54.189962Z","shell.execute_reply":"2025-07-28T15:59:54.189162Z"},"papermill":{"duration":0.015831,"end_time":"2025-07-28T15:59:54.191059","exception":false,"start_time":"2025-07-28T15:59:54.175228","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 18524 entries, 0 to 18523\n","Data columns (total 8 columns):\n"," #   Column                     Non-Null Count  Dtype  \n","---  ------                     --------------  -----  \n"," 0   id                         18524 non-null  int64  \n"," 1   Time_spent_Alone           17334 non-null  float64\n"," 2   Stage_fear                 16631 non-null  object \n"," 3   Social_event_attendance    17344 non-null  float64\n"," 4   Going_outside              17058 non-null  float64\n"," 5   Drained_after_socializing  17375 non-null  object \n"," 6   Friends_circle_size        17470 non-null  float64\n"," 7   Post_frequency             17260 non-null  float64\n","dtypes: float64(5), int64(1), object(2)\n","memory usage: 1.1+ MB\n"]}],"source":["# train_data = train_data.dropna()\n","train_data.info()"]},{"cell_type":"code","execution_count":5,"id":"086b68cf","metadata":{"execution":{"iopub.execute_input":"2025-07-28T15:59:54.201318Z","iopub.status.busy":"2025-07-28T15:59:54.200872Z","iopub.status.idle":"2025-07-28T15:59:54.209604Z","shell.execute_reply":"2025-07-28T15:59:54.208973Z"},"papermill":{"duration":0.014994,"end_time":"2025-07-28T15:59:54.210705","exception":false,"start_time":"2025-07-28T15:59:54.195711","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["id Contains the values : [    0     1     2 ... 18521 18522 18523]\n","Time_spent_Alone Contains the values : [ 0.  1.  6.  3.  2.  4. nan  5.  9. 10.  7.  8. 11.]\n","Stage_fear Contains the values : ['No' 'Yes' nan]\n","Social_event_attendance Contains the values : [ 6.  7.  1.  4.  8.  2.  5. nan  0.  9.  3. 10.]\n","Going_outside Contains the values : [ 4.  3.  0.  5. nan  1.  6.  2.  7.]\n","Drained_after_socializing Contains the values : ['No' nan 'Yes']\n","Friends_circle_size Contains the values : [15. 10.  3. 11. 13. nan  4.  0. 14.  5.  9. 12.  8.  2.  1.  6.  7.]\n","Post_frequency Contains the values : [ 5.  8.  0. nan  3.  4.  2.  9. 10.  6.  7.  1.]\n"]}],"source":["for cols in train_data.columns:\n","    print(f\"{cols} Contains the values : {train_data[cols].unique()}\")"]},{"cell_type":"code","execution_count":6,"id":"df44186a","metadata":{"execution":{"iopub.execute_input":"2025-07-28T15:59:54.220682Z","iopub.status.busy":"2025-07-28T15:59:54.220493Z","iopub.status.idle":"2025-07-28T15:59:54.225512Z","shell.execute_reply":"2025-07-28T15:59:54.224979Z"},"papermill":{"duration":0.010989,"end_time":"2025-07-28T15:59:54.226614","exception":false,"start_time":"2025-07-28T15:59:54.215625","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["['Stage_fear', 'Drained_after_socializing']"]},"execution_count":6,"metadata":{},"output_type":"execute_result"}],"source":["s = (train_data.dtypes=='object')\n","obj_cols = list(s[s].index)\n","\n","obj_cols"]},{"cell_type":"code","execution_count":7,"id":"f42d3655","metadata":{"execution":{"iopub.execute_input":"2025-07-28T15:59:54.237462Z","iopub.status.busy":"2025-07-28T15:59:54.237039Z","iopub.status.idle":"2025-07-28T15:59:55.380819Z","shell.execute_reply":"2025-07-28T15:59:55.380269Z"},"papermill":{"duration":1.150144,"end_time":"2025-07-28T15:59:55.382184","exception":false,"start_time":"2025-07-28T15:59:54.23204","status":"completed"},"tags":[]},"outputs":[],"source":["from sklearn.preprocessing import OrdinalEncoder\n","\n","encoder = OrdinalEncoder()\n","\n","encoded_train_data = train_data.copy()\n","encoded_test_data = test_data.copy()\n","\n","encoded_train_data[obj_cols] = encoder.fit_transform(train_data[obj_cols])\n","\n","encoded_test_data[obj_cols] = encoder.transform(test_data[obj_cols])"]},{"cell_type":"code","execution_count":8,"id":"4f4502b5","metadata":{"execution":{"iopub.execute_input":"2025-07-28T15:59:55.392614Z","iopub.status.busy":"2025-07-28T15:59:55.392319Z","iopub.status.idle":"2025-07-28T15:59:55.399261Z","shell.execute_reply":"2025-07-28T15:59:55.398657Z"},"papermill":{"duration":0.013249,"end_time":"2025-07-28T15:59:55.400349","exception":false,"start_time":"2025-07-28T15:59:55.3871","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["The missing columns are ['Time_spent_Alone', 'Stage_fear', 'Social_event_attendance', 'Going_outside', 'Drained_after_socializing', 'Friends_circle_size', 'Post_frequency']\n"]}],"source":["col_missing= [col for col in train_data.columns if train_data[col].isnull().any()]\n","print(f\"The missing columns are {col_missing}\")\n","    "]},{"cell_type":"markdown","id":"a5025164","metadata":{"papermill":{"duration":0.004422,"end_time":"2025-07-28T15:59:55.409724","exception":false,"start_time":"2025-07-28T15:59:55.405302","status":"completed"},"tags":[]},"source":["Drained_after_socializing and Stage_fear columns contains \"yes\" or \"no\". so after imputation its value shouldbe 0 or 1."]},{"cell_type":"code","execution_count":9,"id":"dde0058d","metadata":{"execution":{"iopub.execute_input":"2025-07-28T15:59:55.419869Z","iopub.status.busy":"2025-07-28T15:59:55.419661Z","iopub.status.idle":"2025-07-28T16:00:06.895167Z","shell.execute_reply":"2025-07-28T16:00:06.894599Z"},"papermill":{"duration":11.482212,"end_time":"2025-07-28T16:00:06.896592","exception":false,"start_time":"2025-07-28T15:59:55.41438","status":"completed"},"tags":[]},"outputs":[],"source":["from sklearn.impute import KNNImputer\n","\n","\n","impute = KNNImputer(n_neighbors=10)\n","imputed_train_data = pd.DataFrame(impute.fit_transform(encoded_train_data))\n","imputed_test_data = pd.DataFrame(impute.transform(encoded_test_data))\n","\n","\n","imputed_train_data.columns = encoded_train_data.columns\n","imputed_test_data.columns = encoded_test_data.columns\n","\n","# Columns to apply threshold logic\n","binary_cols = ['Stage_fear', 'Drained_after_socializing']\n","\n","# Apply binary thresholding to selected columns\n","for col in binary_cols:\n","    imputed_train_data[col] = imputed_train_data[col].apply(lambda x: 1.0 if x > 0.5 else 0.0)\n","    imputed_test_data[col] = imputed_test_data[col].apply(lambda x: 1.0 if x > 0.5 else 0.0)\n"]},{"cell_type":"code","execution_count":10,"id":"624bb535","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:06.907294Z","iopub.status.busy":"2025-07-28T16:00:06.90703Z","iopub.status.idle":"2025-07-28T16:00:06.91028Z","shell.execute_reply":"2025-07-28T16:00:06.909733Z"},"papermill":{"duration":0.009554,"end_time":"2025-07-28T16:00:06.911275","exception":false,"start_time":"2025-07-28T16:00:06.901721","status":"completed"},"tags":[]},"outputs":[],"source":["# # Time spent alone vs. friends\n","# imputed_train_data['Alone_vs_Friends'] = imputed_train_data['Time_spent_Alone'] / (imputed_train_data['Friends_circle_size'] + 1e-5)\n","\n","# # Social activity level\n","# imputed_train_data['Social_score'] = (imputed_train_data['Social_event_attendance'] + imputed_train_data['Post_frequency'] + imputed_train_data['Going_outside']) / 3\n","\n","# # Time spent alone vs. friends (avoid division by zero)\n","# imputed_test_data['Alone_vs_Friends'] = imputed_test_data['Time_spent_Alone'] / (imputed_test_data['Friends_circle_size'] + 1e-5)\n","\n","# # Social activity score\n","# imputed_test_data['Social_score'] = (\n","#     imputed_test_data['Social_event_attendance'] + \n","#     imputed_test_data['Post_frequency'] + \n","#     imputed_test_data['Going_outside']\n","# ) / 3\n"]},{"cell_type":"code","execution_count":11,"id":"ba5cb01a","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:06.921319Z","iopub.status.busy":"2025-07-28T16:00:06.920866Z","iopub.status.idle":"2025-07-28T16:00:06.929615Z","shell.execute_reply":"2025-07-28T16:00:06.928901Z"},"papermill":{"duration":0.014922,"end_time":"2025-07-28T16:00:06.930699","exception":false,"start_time":"2025-07-28T16:00:06.915777","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 18524 entries, 0 to 18523\n","Data columns (total 8 columns):\n"," #   Column                     Non-Null Count  Dtype  \n","---  ------                     --------------  -----  \n"," 0   id                         18524 non-null  float64\n"," 1   Time_spent_Alone           18524 non-null  float64\n"," 2   Stage_fear                 18524 non-null  float64\n"," 3   Social_event_attendance    18524 non-null  float64\n"," 4   Going_outside              18524 non-null  float64\n"," 5   Drained_after_socializing  18524 non-null  float64\n"," 6   Friends_circle_size        18524 non-null  float64\n"," 7   Post_frequency             18524 non-null  float64\n","dtypes: float64(8)\n","memory usage: 1.1 MB\n"]}],"source":["imputed_train_data.info()"]},{"cell_type":"code","execution_count":12,"id":"f3f2a54e","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:06.940966Z","iopub.status.busy":"2025-07-28T16:00:06.940776Z","iopub.status.idle":"2025-07-28T16:00:06.94525Z","shell.execute_reply":"2025-07-28T16:00:06.944713Z"},"papermill":{"duration":0.010724,"end_time":"2025-07-28T16:00:06.946328","exception":false,"start_time":"2025-07-28T16:00:06.935604","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["2"]},"execution_count":12,"metadata":{},"output_type":"execute_result"}],"source":["y.nunique()\n"]},{"cell_type":"code","execution_count":13,"id":"c05e1569","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:06.956448Z","iopub.status.busy":"2025-07-28T16:00:06.956242Z","iopub.status.idle":"2025-07-28T16:00:06.960753Z","shell.execute_reply":"2025-07-28T16:00:06.96007Z"},"papermill":{"duration":0.010815,"end_time":"2025-07-28T16:00:06.961859","exception":false,"start_time":"2025-07-28T16:00:06.951044","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["0    1\n","1    1\n","2    0\n","3    1\n","4    1\n","Name: Personality, dtype: int64"]},"execution_count":13,"metadata":{},"output_type":"execute_result"}],"source":["y.head()"]},{"cell_type":"code","execution_count":14,"id":"3a85c78a","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:06.972429Z","iopub.status.busy":"2025-07-28T16:00:06.97206Z","iopub.status.idle":"2025-07-28T16:00:06.999406Z","shell.execute_reply":"2025-07-28T16:00:06.998555Z"},"papermill":{"duration":0.033893,"end_time":"2025-07-28T16:00:07.000493","exception":false,"start_time":"2025-07-28T16:00:06.9666","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["\n","Before Conversion:\n","id Contains the values : [0.0000e+00 1.0000e+00 2.0000e+00 ... 1.8521e+04 1.8522e+04 1.8523e+04]\n","\n","After conversion:\n","id Contains the values : [0.0000e+00 1.0000e+00 2.0000e+00 ... 1.8521e+04 1.8522e+04 1.8523e+04]\n","\n","Before Conversion:\n","Time_spent_Alone Contains the values : [ 0.   1.   6.   3.   2.   4.   1.9  5.   9.   4.9  2.6  1.3 10.   7.\n","  8.   3.2 11.   2.1  2.2  6.6  2.7  2.8  1.6  3.3  2.3  2.4  3.9  6.3\n","  6.1  2.5  4.3  1.2  1.1  4.2  4.4  5.7  4.6  1.7  3.7  2.9  4.1  4.8\n","  3.5  1.5  3.6  3.1  5.1  5.5  1.8  4.7  0.9  3.8  4.5  1.4  3.4  6.8\n","  6.9  5.8  6.5  5.6  5.3  5.2  0.8  0.5  6.2  5.9  6.7  0.6  5.4  7.9\n","  6.4  0.4  0.7  7.2  7.7]\n","\n","After conversion:\n","Time_spent_Alone Contains the values : [ 0.  1.  6.  3.  2.  4.  5.  9. 10.  7.  8. 11.]\n","\n","Before Conversion:\n","Stage_fear Contains the values : [0. 1.]\n","\n","After conversion:\n","Stage_fear Contains the values : [0. 1.]\n","\n","Before Conversion:\n","Social_event_attendance Contains the values : [ 6.   7.   1.   4.   8.   2.   5.   6.7  0.   5.7  9.   3.   6.5  3.3\n","  6.2  4.4 10.   3.5  2.5  7.7  5.8  3.9  2.3  3.7  2.8  7.2  4.6  6.3\n","  3.1  3.4  5.5  4.8  6.6  4.2  4.9  6.8  6.4  5.9  3.8  4.3  4.5  5.4\n","  5.2  5.1  7.5  5.6  2.4  4.7  3.6  6.1  4.1  7.4  7.1  2.6  6.9  5.3\n","  3.2  7.9  7.6  7.8  2.9  2.7  1.9  7.3  2.2  1.8  2.1  1.6  8.4]\n","\n","After conversion:\n","Social_event_attendance Contains the values : [ 6.  7.  1.  4.  8.  2.  5.  0.  9.  3. 10.]\n","\n","Before Conversion:\n","Going_outside Contains the values : [4.  3.  0.  5.  3.9 1.  6.  2.  7.  3.5 4.8 3.3 1.7 2.9 3.7 3.8 2.6 4.4\n"," 3.6 4.6 4.9 4.1 4.5 4.3 2.1 2.4 1.9 4.2 4.7 3.4 5.1 2.7 2.3 5.3 5.2 3.2\n"," 5.5 5.8 2.8 1.8 5.6 5.7 2.5 1.6 5.4 5.9 1.4 3.1 2.2 6.3 6.1 1.3 6.2 1.5\n"," 1.2]\n","\n","After conversion:\n","Going_outside Contains the values : [4. 3. 0. 5. 1. 6. 2. 7.]\n","\n","Before Conversion:\n","Drained_after_socializing Contains the values : [0. 1.]\n","\n","After conversion:\n","Drained_after_socializing Contains the values : [0. 1.]\n","\n","Before Conversion:\n","Friends_circle_size Contains the values : [15.  10.   3.  11.  13.   8.5  4.   0.  14.   5.   9.  12.   8.   2.\n","  1.   6.   7.   5.6  3.9  7.5 11.2  8.7  3.6 10.2  9.9  7.2 10.3  9.2\n","  8.3  4.6  5.1  5.5  6.5  9.7  6.1  6.3  8.4  6.4  8.9  7.7 11.4  4.3\n","  9.3  9.5  5.8  5.4  6.7  9.1  7.9 10.1 10.9  7.4  8.8  9.8  7.6  5.3\n","  7.8  5.7 10.8  8.1  7.3  8.2  9.6  8.6  7.1 12.1  6.9 11.5  9.4  4.9\n"," 10.6  4.4  3.8  4.7  4.8  6.6 11.3  5.2 10.4  6.8 10.5  6.2  3.4 11.6\n"," 11.1 10.7  4.5  5.9 12.5 11.7  3.5 12.4  4.2  2.9  3.7  4.1 11.9  3.1]\n","\n","After conversion:\n","Friends_circle_size Contains the values : [15. 10.  3. 11. 13.  8.  4.  0. 14.  5.  9. 12.  2.  1.  6.  7.]\n","\n","Before Conversion:\n","Post_frequency Contains the values : [ 5.   8.   0.   6.   3.   4.   2.   9.  10.   7.5  7.   1.   5.3  1.4\n","  5.8  6.2  6.4  3.4  5.9  3.8  4.6  6.7  6.8  4.8  4.2  2.7  1.3  6.9\n","  4.3  5.5  4.9  6.1  4.4  5.6  7.2  7.3  4.5  5.4  2.9  2.6  6.6  3.1\n","  3.5  3.6  3.2  5.1  6.3  1.7  4.1  5.2  3.9  3.7  4.7  6.5  2.8  3.3\n","  7.1  5.7  7.4  1.6  1.9  2.5  7.9  2.2  2.1  2.3  2.4  7.6  7.7  7.8\n","  1.8  1.5]\n","\n","After conversion:\n","Post_frequency Contains the values : [ 5.  8.  0.  6.  3.  4.  2.  9. 10.  7.  1.]\n"]}],"source":["for cols in imputed_train_data.columns:\n","    print(f\"\\nBefore Conversion:\")\n","    print(f\"{cols} Contains the values : {imputed_train_data[cols].unique()}\")\n","    print(f\"\\nAfter conversion:\")\n","    imputed_train_data[cols] = np.floor(imputed_train_data[cols]).astype(float)\n","    imputed_test_data[cols] = np.floor(imputed_test_data[cols]).astype(float)\n","    print(f\"{cols} Contains the values : {imputed_train_data[cols].unique()}\")"]},{"cell_type":"code","execution_count":15,"id":"f8ce571e","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:07.011315Z","iopub.status.busy":"2025-07-28T16:00:07.010691Z","iopub.status.idle":"2025-07-28T16:00:07.01825Z","shell.execute_reply":"2025-07-28T16:00:07.017644Z"},"papermill":{"duration":0.013915,"end_time":"2025-07-28T16:00:07.019315","exception":false,"start_time":"2025-07-28T16:00:07.0054","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 18524 entries, 0 to 18523\n","Data columns (total 8 columns):\n"," #   Column                     Non-Null Count  Dtype  \n","---  ------                     --------------  -----  \n"," 0   id                         18524 non-null  float64\n"," 1   Time_spent_Alone           18524 non-null  float64\n"," 2   Stage_fear                 18524 non-null  float64\n"," 3   Social_event_attendance    18524 non-null  float64\n"," 4   Going_outside              18524 non-null  float64\n"," 5   Drained_after_socializing  18524 non-null  float64\n"," 6   Friends_circle_size        18524 non-null  float64\n"," 7   Post_frequency             18524 non-null  float64\n","dtypes: float64(8)\n","memory usage: 1.1 MB\n"]}],"source":["imputed_train_data.info()"]},{"cell_type":"code","execution_count":16,"id":"14617b3d","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:07.030359Z","iopub.status.busy":"2025-07-28T16:00:07.029664Z","iopub.status.idle":"2025-07-28T16:00:07.032967Z","shell.execute_reply":"2025-07-28T16:00:07.032322Z"},"papermill":{"duration":0.009607,"end_time":"2025-07-28T16:00:07.033926","exception":false,"start_time":"2025-07-28T16:00:07.024319","status":"completed"},"tags":[]},"outputs":[],"source":["# from sklearn.preprocessing import MinMaxScaler\n","\n","# num_cols = [\n","#     'Time_spent_Alone',\n","#     'Social_event_attendance',\n","#     'Going_outside',\n","#     'Friends_circle_size',\n","#     'Post_frequency',\n","#     # 'Alone_vs_Friends',\n","#     # 'Social_score'\n","# ]\n","\n","# scaler = MinMaxScaler()\n","# imputed_train_data[num_cols] = scaler.fit_transform(imputed_train_data[num_cols])\n","# imputed_test_data[num_cols] = scaler.transform(imputed_test_data[num_cols])\n","\n"]},{"cell_type":"code","execution_count":17,"id":"ab69e01c","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:07.044566Z","iopub.status.busy":"2025-07-28T16:00:07.044372Z","iopub.status.idle":"2025-07-28T16:00:07.052942Z","shell.execute_reply":"2025-07-28T16:00:07.052266Z"},"papermill":{"duration":0.015136,"end_time":"2025-07-28T16:00:07.053966","exception":false,"start_time":"2025-07-28T16:00:07.03883","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["(16671, 8)\n","(1853, 8)\n"]}],"source":["from sklearn.model_selection import train_test_split\n","trainX,valX,trainY,valY = train_test_split(imputed_train_data,y,train_size=0.9,random_state=2)\n","\n","print(trainX.shape)\n","print(valX.shape)\n","\n"]},{"cell_type":"code","execution_count":18,"id":"6b5f722c","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:07.06448Z","iopub.status.busy":"2025-07-28T16:00:07.064154Z","iopub.status.idle":"2025-07-28T16:00:07.082786Z","shell.execute_reply":"2025-07-28T16:00:07.082138Z"},"papermill":{"duration":0.024972,"end_time":"2025-07-28T16:00:07.083772","exception":false,"start_time":"2025-07-28T16:00:07.0588","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>Time_spent_Alone</th>\n","      <th>Stage_fear</th>\n","      <th>Social_event_attendance</th>\n","      <th>Going_outside</th>\n","      <th>Drained_after_socializing</th>\n","      <th>Friends_circle_size</th>\n","      <th>Post_frequency</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>15.0</td>\n","      <td>5.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>7.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>10.0</td>\n","      <td>8.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2.0</td>\n","      <td>6.0</td>\n","      <td>1.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>7.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>11.0</td>\n","      <td>5.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>13.0</td>\n","      <td>6.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["    id  Time_spent_Alone  Stage_fear  Social_event_attendance  Going_outside  \\\n","0  0.0               0.0         0.0                      6.0            4.0   \n","1  1.0               1.0         0.0                      7.0            3.0   \n","2  2.0               6.0         1.0                      1.0            0.0   \n","3  3.0               3.0         0.0                      7.0            3.0   \n","4  4.0               1.0         0.0                      4.0            4.0   \n","\n","   Drained_after_socializing  Friends_circle_size  Post_frequency  \n","0                        0.0                 15.0             5.0  \n","1                        0.0                 10.0             8.0  \n","2                        0.0                  3.0             0.0  \n","3                        0.0                 11.0             5.0  \n","4                        0.0                 13.0             6.0  "]},"execution_count":18,"metadata":{},"output_type":"execute_result"}],"source":["imputed_train_data.head()"]},{"cell_type":"code","execution_count":19,"id":"680d1837","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:07.094697Z","iopub.status.busy":"2025-07-28T16:00:07.094526Z","iopub.status.idle":"2025-07-28T16:00:07.533697Z","shell.execute_reply":"2025-07-28T16:00:07.533156Z"},"papermill":{"duration":0.445989,"end_time":"2025-07-28T16:00:07.535005","exception":false,"start_time":"2025-07-28T16:00:07.089016","status":"completed"},"tags":[]},"outputs":[],"source":["from xgboost import XGBClassifier\n","\n","# model = XGBClassifier()\n","\n","# n_estimators=1000,max_depth=5,learning_rate=0.04,random_state=1"]},{"cell_type":"code","execution_count":20,"id":"8386c4ff","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:07.546482Z","iopub.status.busy":"2025-07-28T16:00:07.546266Z","iopub.status.idle":"2025-07-28T16:00:07.549601Z","shell.execute_reply":"2025-07-28T16:00:07.548873Z"},"papermill":{"duration":0.010112,"end_time":"2025-07-28T16:00:07.550657","exception":false,"start_time":"2025-07-28T16:00:07.540545","status":"completed"},"tags":[]},"outputs":[],"source":["# from sklearn.metrics import accuracy_score\n","# from xgboost import XGBClassifier\n","# import matplotlib.pyplot as plt\n","# import numpy as np  \n","\n","# scores = []\n","# depth_values = list(range(1, 25))  \n","\n","# for k in depth_values:\n","#     rfc = XGBClassifier(n_estimators=200, max_depth=k, learning_rate=0.01, use_label_encoder=False, eval_metric='logloss',random_state=1)\n","#     rfc.fit(trainX, trainY)\n","#     y_pred = rfc.predict(valX)\n","#     scores.append(accuracy_score(valY, y_pred))\n","\n","# x_ticks = np.arange(1, 25, 1)  \n","\n","# plt.figure(figsize=(10, 6))\n","# plt.plot(depth_values, scores, marker='o', linestyle='--', color='b')\n","# plt.xlabel('max_depth for XGBoost Classifier')\n","# plt.ylabel('Validation Accuracy')\n","# plt.title('Effect of max_depth on Accuracy')\n","# plt.grid(True)\n","# plt.xticks(x_ticks)  \n","# plt.tight_layout()\n","# plt.show()\n"]},{"cell_type":"code","execution_count":21,"id":"7579ef4c","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:07.561605Z","iopub.status.busy":"2025-07-28T16:00:07.561411Z","iopub.status.idle":"2025-07-28T16:00:07.564327Z","shell.execute_reply":"2025-07-28T16:00:07.563844Z"},"papermill":{"duration":0.009495,"end_time":"2025-07-28T16:00:07.565341","exception":false,"start_time":"2025-07-28T16:00:07.555846","status":"completed"},"tags":[]},"outputs":[],"source":["# from sklearn.metrics import accuracy_score\n","\n","# scores =[]\n","# for k in range(100, 2000,100):\n","#     rfc = XGBClassifier(n_estimators=k,max_depth=9,learning_rate=0.01,use_label_encoder=False, eval_metric='logloss',random_state=1)\n","#     rfc.fit(trainX, trainY)\n","#     y_pred = rfc.predict(valX)\n","#     scores.append(accuracy_score(valY, y_pred))\n","\n","# import matplotlib.pyplot as plt\n","# %matplotlib inline\n","\n","# # plot the relationship between K and testing accuracy\n","# # plt.plot(x_axis, y_axis)\n","# plt.plot(range(100, 2000, 100), scores)\n","# plt.xlabel('Value of n_estimators for Random Forest Classifier')\n","# plt.ylabel('Testing Accuracy')\n","# x_ticks = np.arange(100, 2000, 100)\n","# plt.grid(True)\n","# plt.xticks(x_ticks)  \n","# plt.tight_layout()\n","# plt.show()\n"]},{"cell_type":"code","execution_count":22,"id":"be35cfa4","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:07.576448Z","iopub.status.busy":"2025-07-28T16:00:07.575997Z","iopub.status.idle":"2025-07-28T16:00:07.5791Z","shell.execute_reply":"2025-07-28T16:00:07.578597Z"},"papermill":{"duration":0.009684,"end_time":"2025-07-28T16:00:07.580146","exception":false,"start_time":"2025-07-28T16:00:07.570462","status":"completed"},"tags":[]},"outputs":[],"source":["# from sklearn.metrics import accuracy_score\n","# from xgboost import XGBClassifier\n","# import numpy as np\n","# import matplotlib.pyplot as plt\n","\n","# scores = []\n","# learning_rates = np.arange(0.01, 1.01, 0.01)  \n","\n","# for lr in learning_rates:\n","#     model = XGBClassifier(n_estimators=200, max_depth=9, learning_rate=lr, use_label_encoder=False, eval_metric='logloss',random_state=1)\n","#     model.fit(trainX, trainY)\n","#     y_pred = model.predict(valX)\n","#     acc = accuracy_score(valY, y_pred)\n","#     scores.append(acc)\n","\n","# # Plotting\n","# plt.figure(figsize=(8, 5))\n","# plt.plot(learning_rates, scores, color='b')\n","# plt.xlabel('Learning Rate')\n","# plt.ylabel('Validation Accuracy')\n","# plt.title('Effect of Learning Rate on Accuracy')\n","# plt.grid(True)\n","\n","# tick_positions = np.arange(0, len(learning_rates), 2)  # every 2th index\n","# tick_labels = [f\"{learning_rates[i]:.2f}\" for i in tick_positions]  # format to 2 decimal places\n","\n","# plt.xticks(ticks=learning_rates[tick_positions], labels=tick_labels, rotation=45)\n","\n","# plt.tight_layout()\n","\n","# plt.show()\n","\n"]},{"cell_type":"code","execution_count":23,"id":"1292dda7","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:07.591558Z","iopub.status.busy":"2025-07-28T16:00:07.590951Z","iopub.status.idle":"2025-07-28T16:00:07.594083Z","shell.execute_reply":"2025-07-28T16:00:07.593581Z"},"papermill":{"duration":0.009765,"end_time":"2025-07-28T16:00:07.595048","exception":false,"start_time":"2025-07-28T16:00:07.585283","status":"completed"},"tags":[]},"outputs":[],"source":["# from sklearn.model_selection import GridSearchCV, StratifiedKFold\n","# from xgboost import XGBClassifier\n","\n","# # Define hyperparameter grid (based on your manual ranges)\n","# param_grid = {\n","#     'max_depth': list(range(3, 11, 1)),          # same as your depth_values\n","#     'n_estimators': list(range(100, 1000, 100)), # sampled from your estimator range\n","#     'learning_rate': np.arange(0.01, 0.2, 0.02) # narrower LR range for efficiency\n","# }\n","\n","# # Initialize model\n","# xgb = XGBClassifier(use_label_encoder=False, eval_metric='logloss', random_state=1)\n","\n","# # Cross-validation strategy\n","# cv = StratifiedKFold(n_splits=5, shuffle=True, random_state=1)\n","\n","# # Grid search with accuracy scoring\n","# grid_search = GridSearchCV(\n","#     estimator=xgb,\n","#     param_grid=param_grid,\n","#     scoring='accuracy',\n","#     cv=cv,\n","#     verbose=2,\n","#     n_jobs=-1\n","# )\n","\n","# # Fit the grid search\n","# grid_search.fit(trainX, trainY)\n","\n","\n"]},{"cell_type":"markdown","id":"246a5255","metadata":{"papermill":{"duration":0.005081,"end_time":"2025-07-28T16:00:07.605453","exception":false,"start_time":"2025-07-28T16:00:07.600372","status":"completed"},"tags":[]},"source":["we got :\n","\n","1) Case-1\n","Best Parameters: {'learning_rate': 0.01, 'max_depth': 2, 'n_estimators': 300}\n","\n","Best Cross-Validated Accuracy: 0.96880780365666\n","\n","2) Case-2\n","Best Parameters: {'learning_rate': 0.08999999999999998, 'max_depth': 3, 'n_estimators': 100}\n","\n","Best Cross-Validated Accuracy: 0.9686878276518609"]},{"cell_type":"code","execution_count":24,"id":"b5964801","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:07.616704Z","iopub.status.busy":"2025-07-28T16:00:07.616209Z","iopub.status.idle":"2025-07-28T16:00:07.619001Z","shell.execute_reply":"2025-07-28T16:00:07.618517Z"},"papermill":{"duration":0.009442,"end_time":"2025-07-28T16:00:07.619959","exception":false,"start_time":"2025-07-28T16:00:07.610517","status":"completed"},"tags":[]},"outputs":[],"source":["# from sklearn.metrics import accuracy_score\n","\n","# # Best parameters and score\n","# print(\"Best Parameters:\", grid_search.best_params_)\n","# print(\"Best Cross-Validated Accuracy:\", grid_search.best_score_)\n","\n","# best_model = grid_search.best_estimator_\n","\n","# # Evaluate on validation set\n","# val_pred = best_model.predict(valX)\n","# val_acc = accuracy_score(valY, val_pred)\n","# print(\"Validation Accuracy with Best Model:\", val_acc)\n","\n","\n","\n","\n","\n","\n"]},{"cell_type":"code","execution_count":25,"id":"e0597cd5","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:07.631359Z","iopub.status.busy":"2025-07-28T16:00:07.63076Z","iopub.status.idle":"2025-07-28T16:00:07.831892Z","shell.execute_reply":"2025-07-28T16:00:07.831281Z"},"papermill":{"duration":0.207972,"end_time":"2025-07-28T16:00:07.833175","exception":false,"start_time":"2025-07-28T16:00:07.625203","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>XGBClassifier(base_score=None, booster=None, callbacks=None,\n","              colsample_bylevel=None, colsample_bynode=None,\n","              colsample_bytree=None, device=None, early_stopping_rounds=None,\n","              enable_categorical=False, eval_metric=&#x27;logloss&#x27;,\n","              feature_types=None, gamma=None, grow_policy=None,\n","              importance_type=None, interaction_constraints=None,\n","              learning_rate=0.2, max_bin=None, max_cat_threshold=None,\n","              max_cat_to_onehot=None, max_delta_step=None, max_depth=4,\n","              max_leaves=None, min_child_weight=None, missing=nan,\n","              monotone_constraints=None, multi_strategy=None, n_estimators=100,\n","              n_jobs=None, num_parallel_tree=None, random_state=1, ...)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">XGBClassifier</label><div class=\"sk-toggleable__content\"><pre>XGBClassifier(base_score=None, booster=None, callbacks=None,\n","              colsample_bylevel=None, colsample_bynode=None,\n","              colsample_bytree=None, device=None, early_stopping_rounds=None,\n","              enable_categorical=False, eval_metric=&#x27;logloss&#x27;,\n","              feature_types=None, gamma=None, grow_policy=None,\n","              importance_type=None, interaction_constraints=None,\n","              learning_rate=0.2, max_bin=None, max_cat_threshold=None,\n","              max_cat_to_onehot=None, max_delta_step=None, max_depth=4,\n","              max_leaves=None, min_child_weight=None, missing=nan,\n","              monotone_constraints=None, multi_strategy=None, n_estimators=100,\n","              n_jobs=None, num_parallel_tree=None, random_state=1, ...)</pre></div></div></div></div></div>"],"text/plain":["XGBClassifier(base_score=None, booster=None, callbacks=None,\n","              colsample_bylevel=None, colsample_bynode=None,\n","              colsample_bytree=None, device=None, early_stopping_rounds=None,\n","              enable_categorical=False, eval_metric='logloss',\n","              feature_types=None, gamma=None, grow_policy=None,\n","              importance_type=None, interaction_constraints=None,\n","              learning_rate=0.2, max_bin=None, max_cat_threshold=None,\n","              max_cat_to_onehot=None, max_delta_step=None, max_depth=4,\n","              max_leaves=None, min_child_weight=None, missing=nan,\n","              monotone_constraints=None, multi_strategy=None, n_estimators=100,\n","              n_jobs=None, num_parallel_tree=None, random_state=1, ...)"]},"execution_count":25,"metadata":{},"output_type":"execute_result"}],"source":["model = XGBClassifier(n_estimators=100,max_depth=4,learning_rate= 0.2,use_label_encoder=False, eval_metric='logloss',random_state=1)\n","model.fit(trainX,trainY)"]},{"cell_type":"code","execution_count":26,"id":"ae80ad90","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:07.84571Z","iopub.status.busy":"2025-07-28T16:00:07.845493Z","iopub.status.idle":"2025-07-28T16:00:07.852983Z","shell.execute_reply":"2025-07-28T16:00:07.852527Z"},"papermill":{"duration":0.014783,"end_time":"2025-07-28T16:00:07.854238","exception":false,"start_time":"2025-07-28T16:00:07.839455","status":"completed"},"tags":[]},"outputs":[],"source":["pred = model.predict(valX)"]},{"cell_type":"code","execution_count":27,"id":"0ac9ac9e","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:07.868919Z","iopub.status.busy":"2025-07-28T16:00:07.868478Z","iopub.status.idle":"2025-07-28T16:00:07.875784Z","shell.execute_reply":"2025-07-28T16:00:07.875151Z"},"papermill":{"duration":0.015614,"end_time":"2025-07-28T16:00:07.876871","exception":false,"start_time":"2025-07-28T16:00:07.861257","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["percentage aabsolute error: 3.0221262817053427\n"]},{"data":{"text/plain":["96.97787371829466"]},"execution_count":27,"metadata":{},"output_type":"execute_result"}],"source":["from sklearn.metrics import mean_absolute_error, accuracy_score\n"," \n","\n","e=mean_absolute_error(valY,pred)\n","print(f\"percentage aabsolute error: {e*100}\")\n","accuracy_score(valY,pred)*100"]},{"cell_type":"code","execution_count":28,"id":"e8a6b1d0","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:07.888393Z","iopub.status.busy":"2025-07-28T16:00:07.888201Z","iopub.status.idle":"2025-07-28T16:00:07.977547Z","shell.execute_reply":"2025-07-28T16:00:07.977078Z"},"papermill":{"duration":0.096302,"end_time":"2025-07-28T16:00:07.978703","exception":false,"start_time":"2025-07-28T16:00:07.882401","status":"completed"},"tags":[]},"outputs":[],"source":["# Fit on full training data and predict on test set\n","model.fit(imputed_train_data, y)\n","final_predictions = model.predict(imputed_test_data)"]},{"cell_type":"code","execution_count":29,"id":"399f5202","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:07.993237Z","iopub.status.busy":"2025-07-28T16:00:07.993052Z","iopub.status.idle":"2025-07-28T16:00:07.995966Z","shell.execute_reply":"2025-07-28T16:00:07.995475Z"},"papermill":{"duration":0.011171,"end_time":"2025-07-28T16:00:07.996959","exception":false,"start_time":"2025-07-28T16:00:07.985788","status":"completed"},"tags":[]},"outputs":[],"source":["# Convert predictions back to labels\n","final_labels = np.where(final_predictions == 1, 'Extrovert', 'Introvert')\n"]},{"cell_type":"code","execution_count":30,"id":"a4507056","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:08.00851Z","iopub.status.busy":"2025-07-28T16:00:08.00816Z","iopub.status.idle":"2025-07-28T16:00:08.020873Z","shell.execute_reply":"2025-07-28T16:00:08.020398Z"},"papermill":{"duration":0.019415,"end_time":"2025-07-28T16:00:08.021828","exception":false,"start_time":"2025-07-28T16:00:08.002413","status":"completed"},"tags":[]},"outputs":[],"source":["# Prepare submission\n","output = pd.DataFrame({\n","    'id': test_data['id'],\n","    'Personality': final_labels\n","})\n","output.to_csv('submission.csv', index=False)"]},{"cell_type":"code","execution_count":31,"id":"b93cc911","metadata":{"execution":{"iopub.execute_input":"2025-07-28T16:00:08.033287Z","iopub.status.busy":"2025-07-28T16:00:08.033087Z","iopub.status.idle":"2025-07-28T16:00:08.04181Z","shell.execute_reply":"2025-07-28T16:00:08.041083Z"},"papermill":{"duration":0.015541,"end_time":"2025-07-28T16:00:08.042848","exception":false,"start_time":"2025-07-28T16:00:08.027307","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>Personality</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>18524</td>\n","      <td>Extrovert</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>18525</td>\n","      <td>Introvert</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>18526</td>\n","      <td>Extrovert</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>18527</td>\n","      <td>Extrovert</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>18528</td>\n","      <td>Introvert</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["      id Personality\n","0  18524   Extrovert\n","1  18525   Introvert\n","2  18526   Extrovert\n","3  18527   Extrovert\n","4  18528   Introvert"]},"execution_count":31,"metadata":{},"output_type":"execute_result"}],"source":["df = pd.read_csv(\"submission.csv\")\n","df.head()"]},{"cell_type":"code","execution_count":null,"id":"84a7da0f","metadata":{"papermill":{"duration":0.005823,"end_time":"2025-07-28T16:00:08.054288","exception":false,"start_time":"2025-07-28T16:00:08.048465","status":"completed"},"tags":[]},"outputs":[],"source":[]}],"metadata":{"kaggle":{"accelerator":"nvidiaTeslaT4","dataSources":[{"databundleVersionId":12738969,"sourceId":91718,"sourceType":"competition"}],"dockerImageVersionId":31089,"isGpuEnabled":true,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.11.13"},"papermill":{"default_parameters":{},"duration":20.16347,"end_time":"2025-07-28T16:00:08.4767","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-07-28T15:59:48.31323","version":"2.6.0"}},"nbformat":4,"nbformat_minor":5}